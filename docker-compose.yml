services:
  # Database
  postgres:
    image: postgres:15-alpine
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres
      - POSTGRES_DB=transcriber
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  # Message Broker
  rabbitmq:
    image: rabbitmq:3.12-management-alpine
    hostname: transcriber-rabbit
    environment:
      - RABBITMQ_DEFAULT_USER=rabbit
      - RABBITMQ_DEFAULT_PASS=rabbit
    ports:
      - "5672:5672"
      - "15672:15672"
    volumes:
      - rabbitmq_data:/var/lib/rabbitmq/mnesia/rabbit@transcriber-rabbit
      - ./rabbitmq.conf:/etc/rabbitmq/conf.d/rabbitmq.conf

volumes:
  postgres_data:
  rabbitmq_data:
